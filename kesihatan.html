<!DOCTYPE html>
<html lang="ms">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistem Pengesan Tahap Kesihatan Pekerja</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f1f1f1; padding: 20px; }
    .container { max-width: 600px; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); margin: auto; }
    h2 { text-align: center; color: #333; }
    label { display: block; margin-top: 15px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    button { margin-top: 20px; width: 100%; padding: 10px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background-color: #45a049; }
    .status { margin-top: 20px; font-weight: bold; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Borang Pemeriksaan Kesihatan Harian</h2>
    <form id="healthForm">
      <label for="nama">Nama:</label>
      <input type="text" id="nama" name="nama" required>

      <label for="umur">Umur:</label>
      <input type="number" id="umur" name="umur" required>

      <label for="suhu">Suhu Badan (Â°C):</label>
      <input type="number" id="suhu" name="suhu" step="0.1" required>

      <label for="denyut">Kadar Denyutan Jantung (bpm):</label>
      <input type="number" id="denyut" name="denyut" placeholder="Boleh dibiarkan kosong jika tiada alat">

      <label for="spo2">Tahap Oksigen (SpO2 %):</label>
      <input type="number" id="spo2" name="spo2" placeholder="Boleh dibiarkan kosong jika tiada alat">

      <label for="simptom">Adakah anda mengalami sebarang simptom berikut dalam 24 jam terakhir?</label>
      <div id="senaraiSimptom">
        <input type="checkbox" name="simptomList" value="Demam"> Demam<br>
        <input type="checkbox" name="simptomList" value="Batuk"> Batuk<br>
        <input type="checkbox" name="simptomList" value="Sakit tekak"> Sakit tekak<br>
        <input type="checkbox" name="simptomList" value="Selesema"> Selesema<br>
        <input type="checkbox" name="simptomList" value="Sakit kepala"> Sakit kepala<br>
        <input type="checkbox" name="simptomList" value="Keletihan melampau"> Keletihan melampau<br>
        <input type="checkbox" name="simptomList" value="Tiada sebarang simptom"> Tiada sebarang simptom<br>
        <input type="text" name="simptomList" placeholder="Simptom lain...">
      </div>

      <label for="keletihan">Skala Keletihan (1 - 5):</label>
      <select id="keletihan" name="keletihan">
        <option value="1">1 - Sangat Bertenaga</option>
        <option value="2">2 - Agak Bertenaga</option>
        <option value="3">3 - Neutral</option>
        <option value="4">4 - Agak Letih</option>
        <option value="5">5 - Sangat Letih</option>
      </select>

      <button type="submit">Hantar</button>
    </form>

    <div class="status" id="statusKesihatan"></div>
  </div>

  <script>
    document.getElementById('healthForm').addEventListener('submit', function(e) {
      e.preventDefault();

      const nama = document.getElementById('nama').value;
      const umur = document.getElementById('umur').value;
      const suhu = parseFloat(document.getElementById('suhu').value);
      const denyutInput = document.getElementById('denyut').value;
      const spo2Input = document.getElementById('spo2').value;

      const denyut = denyutInput ? parseInt(denyutInput) : null;
      const spo2 = spo2Input ? parseInt(spo2Input) : null;

      const keletihan = parseInt(document.getElementById('keletihan').value);

      const simptomChecked = document.querySelectorAll('input[name="simptomList"]:checked');
      const simptomText = document.querySelectorAll('input[name="simptomList"][type="text"]');

      let simptom = [...simptomChecked].map(cb => cb.value);
      simptomText.forEach(input => {
        if (input.value.trim()) simptom.push(input.value.trim());
      });

      let status = "Sihat";
      if (
        suhu > 37.5 ||
        (denyut !== null && denyut > 100) ||
        (spo2 !== null && spo2 < 95) ||
        keletihan >= 4 ||
        simptom.includes("Batuk") ||
        simptom.includes("Sakit tekak")
      ) {
        status = "Perlu Pemeriksaan Lanjut";
      }

      document.getElementById('statusKesihatan').innerText = `Status Kesihatan: ${status}`;

      const data = {
        nama,
        umur,
        suhu,
        denyut: denyut ?? '',
        spo2: spo2 ?? '',
        simptom,
        keletihan,
        status
      };

      fetch('https://script.google.com/macros/s/AKfycbwwki7fM_NcgSeoLo6bD2CCu_Dlra0AhYh148NNSyGq_Ek8rNz2MfweNF7B_O1yIq5pzw/exec', {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });
    });
  </script>
</body>
</html>
